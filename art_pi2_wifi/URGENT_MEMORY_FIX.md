# ç´§æ€¥å†…å­˜ä¿®å¤æ–¹æ¡ˆ

## âš ï¸ å½“å‰é—®é¢˜

ç³»ç»Ÿæ— æ³•åˆ†é…32KBå†…å­˜ç”¨äºHTTPå“åº”ï¼Œè¯´æ˜å¯ç”¨å†…å­˜ä¸¥é‡ä¸è¶³ã€‚

## ğŸš¨ ç«‹å³å°è¯•çš„æ–¹æ³•

### æ–¹æ³•1ï¼šé‡å¯ç³»ç»Ÿï¼ˆæœ€å¿«ï¼‰

```bash
msh> reboot
```

ç„¶åé‡è¯•ï¼š
```bash
msh> ai_say ä½ å¥½
```

### æ–¹æ³•2ï¼šæ£€æŸ¥å†…å­˜

```bash
msh> free
```

æŸ¥çœ‹è¾“å‡ºä¸­çš„ `free` å€¼ï¼Œå¦‚æœå°äº 50KBï¼Œå†…å­˜ä¸¥é‡ä¸è¶³ã€‚

### æ–¹æ³•3ï¼šåœæ­¢å…¶ä»–æœåŠ¡

```bash
# åœæ­¢è¯­éŸ³åŠ©æ‰‹
msh> va_stop

# åœæ­¢å”¤é†’è¯æ£€æµ‹
msh> wakeup_stop

# å†æ¬¡æ£€æŸ¥å†…å­˜
msh> free

# é‡è¯•
msh> ai_say æµ‹è¯•
```

## ğŸ”§ å·²åº”ç”¨çš„æé™ä¼˜åŒ–

æˆ‘åˆšåˆšè¿›è¡Œäº†æ›´æ¿€è¿›çš„ä¼˜åŒ–ï¼š

| é¡¹ç›® | åŸå€¼ | ä¼˜åŒ–å | èŠ‚çœ |
|------|------|--------|------|
| HTTPç¼“å†²åŒº | 32KB | **16KB** | 16KB |
| éŸ³é¢‘é‡‡é›†ç¼“å†² | 16KB | **8KB** | 8KB |
| éŸ³é¢‘æ’­æ”¾ç¼“å†² | 16KB | **8KB** | 8KB |
| å½•éŸ³æ—¶é•¿ | 5ç§’ | **3ç§’** | ~32KB |
| **æ€»èŠ‚çœ** | - | - | **~64KB** |

## ğŸš€ é‡æ–°ç¼–è¯‘

```bash
# 1. æ¸…ç†
scons -c

# 2. é‡æ–°ç¼–è¯‘ï¼ˆä½¿ç”¨æé™ä¼˜åŒ–ï¼‰
scons -j8

# 3. ä¸‹è½½åˆ°å¼€å‘æ¿
```

## ğŸ“Š æœ€å°å†…å­˜éœ€æ±‚

ä¼˜åŒ–åçš„æœ€å°å†…å­˜éœ€æ±‚ï¼š

```
HTTPç¼“å†²åŒº:      16 KB
éŸ³é¢‘é‡‡é›†:         8 KB  
éŸ³é¢‘æ’­æ”¾:         8 KB
è¯­éŸ³åŠ©æ‰‹:         4 KB
æ ˆç©ºé—´:          8 KB
ç³»ç»Ÿå¼€é”€:        10 KB
----------------------------
æ€»è®¡:           ~54 KB
```

**å»ºè®®ç³»ç»Ÿè‡³å°‘æœ‰ 80KB å¯ç”¨RAMã€‚**

## ğŸ” è¯Šæ–­å‘½ä»¤

### 1. æŸ¥çœ‹å†…å­˜
```bash
msh> free
```

**æœŸæœ›è¾“å‡ºï¼š**
```
total    : 262144  (256KB)
used     : 180000
free     : 82144   â† åº”è¯¥ > 60KB
```

### 2. æŸ¥çœ‹çº¿ç¨‹
```bash
msh> list_thread
```

æŸ¥æ‰¾å ç”¨å†…å­˜å¤šçš„çº¿ç¨‹ã€‚

### 3. æŸ¥çœ‹å¯¹è±¡
```bash
msh> list_mem
```

## âš¡ å¦‚æœä»ç„¶å¤±è´¥

### é€‰é¡¹Aï¼šç¦ç”¨å”¤é†’è¯ï¼ˆèŠ‚çœæ›´å¤šå†…å­˜ï¼‰

ç¼–è¾‘ `voice_assistant_config.h`ï¼š

```c
// ç¦ç”¨å”¤é†’è¯æ£€æµ‹
#define VOICE_WAKEUP_ENABLE     0
```

é‡æ–°ç¼–è¯‘ã€‚

### é€‰é¡¹Bï¼šä½¿ç”¨æœ€å°é…ç½®

åªå¯ç”¨AIæµ‹è¯•åŠŸèƒ½ï¼Œç¦ç”¨å…¶ä»–ï¼š

åœ¨ `main.c` ä¸­ï¼š

```c
int main(void)
{
    // ... LEDåˆå§‹åŒ– ...

    // æ³¨é‡Šæ‰è‡ªåŠ¨å¯åŠ¨è¯­éŸ³åŠ©æ‰‹
    // #if VOICE_ASSISTANT_AUTO_START
    //     voice_assistant_init();
    //     voice_assistant_start();
    // #endif

    // ä¸»å¾ªç¯
    while(1) {
        // ...
    }
}
```

è¿™æ ·åªæœ‰åœ¨æ‰‹åŠ¨è¿è¡Œ `ai_say` æ—¶æ‰åˆ†é…å†…å­˜ã€‚

### é€‰é¡¹Cï¼šå¢åŠ ç³»ç»Ÿå†…å­˜ï¼ˆç¡¬ä»¶æ–¹æ¡ˆï¼‰

å¦‚æœæ˜¯å†…å­˜çœŸçš„ä¸å¤Ÿç”¨ï¼š

1. æ£€æŸ¥ç¡¬ä»¶é…ç½®æ˜¯å¦å¯ç”¨äº†æ‰€æœ‰å¯ç”¨RAM
2. æŸ¥çœ‹æ˜¯å¦å¯ä»¥æ‰©å±•å¤–éƒ¨RAM
3. è€ƒè™‘ä½¿ç”¨å†…å­˜æ›´å¤§çš„å¼€å‘æ¿å‹å·

## ğŸ“ ä¸´æ—¶æµ‹è¯•æ–¹æ³•

å¦‚æœæ— æ³•ç«‹å³é‡æ–°ç¼–è¯‘ï¼Œå¯ä»¥å°è¯•ï¼š

```bash
# 1. é‡å¯æ¸…ç†å†…å­˜
msh> reboot

# 2. ä¸å¯åŠ¨è¯­éŸ³åŠ©æ‰‹ï¼Œç›´æ¥æµ‹è¯•AI
msh> ai_say ä½ å¥½

# 3. å¦‚æœå¤±è´¥ï¼Œå†æ¬¡é‡å¯åç«‹å³æµ‹è¯•
msh> reboot
msh> ai_say æµ‹è¯•
```

## ğŸ¯ æœ€ç»ˆè§£å†³æ–¹æ¡ˆ

### æ ‡å‡†æ–¹æ¡ˆï¼šé‡æ–°ç¼–è¯‘

```bash
scons -c && scons -j8
```

### åº”æ€¥æ–¹æ¡ˆï¼šé‡å¯ç³»ç»Ÿ

```bash
reboot
```

### é•¿æœŸæ–¹æ¡ˆï¼šä¼˜åŒ–é…ç½®

æ ¹æ®å®é™…å†…å­˜æƒ…å†µè°ƒæ•´æ‰€æœ‰ç¼“å†²åŒºå¤§å°ã€‚

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. `free` å‘½ä»¤çš„å®Œæ•´è¾“å‡º
2. `list_thread` çš„è¾“å‡º
3. å¼€å‘æ¿å‹å·å’ŒRAMå¤§å°
4. ç³»ç»Ÿé…ç½®ï¼ˆæ˜¯å¦å¯ç”¨äº†PSRAMç­‰ï¼‰

## âœ… é¢„æœŸæˆåŠŸè¾“å‡º

é‡æ–°ç¼–è¯‘å¹¶é‡å¯åï¼Œåº”è¯¥çœ‹åˆ°ï¼š

```bash
msh> free
total    : 262144
used     : 160000
free     : 102144  âœ… è¶³å¤Ÿäº†

msh> ai_say ä½ å¥½

========================================
[You] ä½ å¥½
========================================
[D/web.client] Allocated 16384 bytes for HTTP response  âœ…
[I/ai.cloud] Text to speech successful
[AI] Processing completed!
========================================
```

---

**ç°åœ¨è¯·å…ˆè¿è¡Œ `free` å‘½ä»¤ï¼Œå‘Šè¯‰æˆ‘å¯ç”¨å†…å­˜æƒ…å†µï¼** ğŸ“Š

